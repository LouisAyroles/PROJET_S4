<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PROJET_S4: couche2.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PROJET_S4
   </div>
   <div id="projectbrief">Projet Semestre 4 Groupe 14 L2 Info UPS Toulouse</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">couche2.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="couche2_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="couche1_8h.html">couche1.h</a>&quot;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="couche2_8h.html">couche2.h</a>&quot;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="couche2_8h.html#a3e5eab04f9ea03705105756c7b8c0782">   23</a></span>&#160; <span class="keywordtype">int</span> <a class="code" href="couche2_8c.html#a3e5eab04f9ea03705105756c7b8c0782">compute_nstripe</a>(<a class="code" href="structvirtual__disk__s.html">virtual_disk_t</a> *<a class="code" href="trash_8c.html#aa32bee7663041ae13a36afeae68a3f14">r5Disk</a>,<span class="keywordtype">int</span> nblocks){</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   <span class="comment">//Dans le cas du raid5 , une bande = n-1 blocs avec n le nombre de disques</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   <span class="comment">//une bande = n blocs, avec n-1 blocs de données et 1 bloc de parité</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   <span class="comment">//Une bande contient donc n-1 bloc des n blocs de données à stocker</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   <span class="keywordflow">return</span> ((nblocks/((r5Disk-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a>)-1))+(nblocks%((r5Disk-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a>)-1) == 0));</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; }</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="couche2_8h.html#a9e6de3169d502aae6d8117e1e6ab03a0">   35</a></span>&#160;<a class="code" href="structblock__s.html">block_t</a> <a class="code" href="couche2_8c.html#a9e6de3169d502aae6d8117e1e6ab03a0">compute_parity</a>(<a class="code" href="structvirtual__disk__s.html">virtual_disk_t</a> *r5, <a class="code" href="structstripe__s.html">stripe_t</a> *tocompute, <span class="keywordtype">int</span> indice_parite){</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="structblock__s.html">block_t</a> retour=tocompute-&gt;<a class="code" href="structstripe__s.html#a16ff6d534dd4944c7fc544e4247e5ff1">stripe</a>[(indice_parite+1)%(tocompute-&gt;<a class="code" href="structstripe__s.html#a076c8e8b7f7acccc46cd356bd8776b26">nblocks</a>)];</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;tocompute-&gt;<a class="code" href="structstripe__s.html#a076c8e8b7f7acccc46cd356bd8776b26">nblocks</a>;i++){</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">if</span>(i!=indice_parite &amp;&amp; i!=((indice_parite+1)%(tocompute-&gt;<a class="code" href="structstripe__s.html#a076c8e8b7f7acccc46cd356bd8776b26">nblocks</a>))){</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <a class="code" href="couche1_8c.html#a69d295ba0ccd1a14fbc7ef4dd2c3a5c9">xorbl</a>(&amp;retour,&amp;(tocompute-&gt;<a class="code" href="structstripe__s.html#a16ff6d534dd4944c7fc544e4247e5ff1">stripe</a>[i]),&amp;retour);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    }</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  }</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordflow">return</span> retour;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="couche2_8h.html#a70860f329dcd21100a6648089f864ed0">   50</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="couche2_8c.html#a70860f329dcd21100a6648089f864ed0">compute_parity_index</a>(<a class="code" href="structvirtual__disk__s.html">virtual_disk_t</a> *r5,<span class="keywordtype">int</span> numbd){</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordflow">if</span> (numbd % r5-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a> == 0){</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">return</span> r5-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a>-1;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  }</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordflow">return</span> ((r5-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a>-1)-(numbd%r5-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a>));</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">//return abs(((r5-&gt;ndisk)-numbd-1)%(r5-&gt;ndisk));</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;}</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="couche2_8h.html#a5033c8eea4a4da6a76284e361f13240d">   63</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="couche2_8c.html#a5033c8eea4a4da6a76284e361f13240d">write_stripe</a>(<a class="code" href="structvirtual__disk__s.html">virtual_disk_t</a> *r5, <a class="code" href="structstripe__s.html">stripe_t</a> *ecrire, <a class="code" href="raid__defines_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> pos){</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;r5-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a>;i++){</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="couche1_8c.html#adb4607cf11ffed5c89fc0f4682bf6079">write_block</a>(r5, &amp;(ecrire-&gt;<a class="code" href="structstripe__s.html#a16ff6d534dd4944c7fc544e4247e5ff1">stripe</a>[i]), pos, i);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  }</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;}</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="couche2_8h.html#ab6170c9cc6975d296a0bccfea207d415">   70</a></span>&#160;<a class="code" href="structstripe__s.html">stripe_t</a> *<a class="code" href="couche2_8c.html#ab6170c9cc6975d296a0bccfea207d415">init_bande</a>(<a class="code" href="structvirtual__disk__s.html">virtual_disk_t</a> *r5){</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="structstripe__s.html">stripe_t</a> *bande = malloc(<span class="keyword">sizeof</span>(<a class="code" href="structstripe__s.html">stripe_t</a>));</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  bande-&gt;<a class="code" href="structstripe__s.html#a076c8e8b7f7acccc46cd356bd8776b26">nblocks</a> = r5-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  bande-&gt;<a class="code" href="structstripe__s.html#a16ff6d534dd4944c7fc544e4247e5ff1">stripe</a> = malloc(<span class="keyword">sizeof</span>(<a class="code" href="structblock__s.html">block_t</a>)*r5-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a>);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">return</span> bande;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="couche2_8h.html#adf66b9197c93775a6c1dba723ba92a07">   82</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="couche2_8c.html#adf66b9197c93775a6c1dba723ba92a07">delete_bande</a>(<a class="code" href="structstripe__s.html">stripe_t</a> **bande){</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  free((*bande)-&gt;stripe);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  free(*bande);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  *bande = NULL;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;}</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="couche2_8h.html#a2fa67e5d44f8746a06cc56ef2876c45e">   93</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="couche2_8c.html#a2fa67e5d44f8746a06cc56ef2876c45e">print_stripe</a>(<a class="code" href="structvirtual__disk__s.html">virtual_disk_t</a> *r5,<a class="code" href="structstripe__s.html">stripe_t</a> *stripe){</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="structblock__s.html">block_t</a> current;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">char</span> nbHexa[<a class="code" href="raid__defines_8h.html#ad51ded0bbd705f02f73fc60c0b721ced">BLOCK_SIZE</a>*2];</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;r5-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a>;i++){</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    current=stripe-&gt;<a class="code" href="structstripe__s.html#a16ff6d534dd4944c7fc544e4247e5ff1">stripe</a>[i];</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="couche1_8c.html#a1fc20a5afdea4eec626e52a499ff46cd">octetsToHexa</a>(current, nbHexa);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="raid__defines_8h.html#ad51ded0bbd705f02f73fc60c0b721ced">BLOCK_SIZE</a>*2; i++){</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      fprintf(stdout, <span class="stringliteral">&quot;[%c]&quot;</span>, nbHexa[i]);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    printf(<span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;}</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="couche2_8h.html#a7ba1127dd9f6b03cbef1c8974790d3c6">  112</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="couche2_8c.html#a7ba1127dd9f6b03cbef1c8974790d3c6">write_chunk</a>(<a class="code" href="structvirtual__disk__s.html">virtual_disk_t</a> *r5, <span class="keywordtype">char</span> *buffer, <span class="keywordtype">int</span> n, <a class="code" href="raid__defines_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> startBlock){</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">int</span> nbBlocks = <a class="code" href="couche1_8c.html#a9cd7d6dccecc07ca1b67fd05c7928ee3">compute_nblock</a>(n);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">int</span> nbBandes = <a class="code" href="couche2_8c.html#a3e5eab04f9ea03705105756c7b8c0782">compute_nstripe</a>(r5,nbBlocks);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">int</span> pos = 0;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="structblock__s.html">block_t</a> bloc[nbBlocks];</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i&lt;nbBlocks; i++){</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j&lt;<a class="code" href="raid__defines_8h.html#ad51ded0bbd705f02f73fc60c0b721ced">BLOCK_SIZE</a>; j++){</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keywordflow">if</span> (pos&lt;n){</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        bloc[i].<a class="code" href="structblock__s.html#aeb657a9749b851021c3ef39acaf7b252">data</a>[j] = buffer[pos];</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        pos++;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">else</span>{</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        bloc[i].<a class="code" href="structblock__s.html#aeb657a9749b851021c3ef39acaf7b252">data</a>[j] = 0;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">//Pos sert maintenant de numdeParité pour les bandes.</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  pos = 0;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="structstripe__s.html">stripe_t</a> *bande=<a class="code" href="couche2_8c.html#ab6170c9cc6975d296a0bccfea207d415">init_bande</a>(r5);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt;= nbBandes; i++){   <span class="comment">//On parcourt le nbBandes</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    pos = <a class="code" href="couche2_8c.html#a70860f329dcd21100a6648089f864ed0">compute_parity_index</a>(r5, i); <span class="comment">//On recupere l&#39;indice de parite</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordtype">int</span> x=0;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt;= r5-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a> - 1 ; j++){ <span class="comment">//On ajoute à la bande les blocs</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">if</span> (j != pos){</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          bande-&gt;<a class="code" href="structstripe__s.html#a16ff6d534dd4944c7fc544e4247e5ff1">stripe</a>[j]=bloc[(i*(r5-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a> - 1))+j-x]; <span class="comment">// ajout de bloc de donnees</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        } <span class="comment">// Fin IF</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordflow">else</span>{</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;          x=1;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    } <span class="comment">// Fin FOR j</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    bande-&gt;<a class="code" href="structstripe__s.html#a16ff6d534dd4944c7fc544e4247e5ff1">stripe</a>[pos] = <a class="code" href="couche2_8c.html#a9e6de3169d502aae6d8117e1e6ab03a0">compute_parity</a>(r5, bande, pos);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="couche2_8c.html#a5033c8eea4a4da6a76284e361f13240d">write_stripe</a>(r5, bande, startBlock*4); <span class="comment">// ecriture de la bande sur disque</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    startBlock+=1;  <span class="comment">// Decalage du block de depart de un block</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  } <span class="comment">// Fin FOR i</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="couche2_8c.html#adf66b9197c93775a6c1dba723ba92a07">delete_bande</a>(&amp;bande);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">/*pas pris en compte l&#39;eventualité de commencer au milieu d&#39;une bande*/</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="couche2_8c.html#a37df3c8400bc0d4673471a52757d023a">  150</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="couche2_8c.html#a37df3c8400bc0d4673471a52757d023a">afficher_raid_hexa</a>(<a class="code" href="structvirtual__disk__s.html">virtual_disk_t</a> *r5){</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordtype">int</span> retour=0;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordtype">int</span> z=0;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordflow">while</span>(retour!=1){</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;r5-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a>;i++){</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      retour=<a class="code" href="couche1_8c.html#ae6cedff3423d9b8afe126d3f298576ee">affichageBlockHexa</a>(r5,i,z,stdout);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordflow">if</span>(retour){</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">return</span>(retour);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      printf(<span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    z=z+4;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;}</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="couche2_8c.html#a5e216cfa058baf4a67b6fc96773fe095">  172</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="couche2_8c.html#a5e216cfa058baf4a67b6fc96773fe095">afficher_raid_decimal</a>(<a class="code" href="structvirtual__disk__s.html">virtual_disk_t</a> *r5){</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordtype">int</span> retour=0;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordtype">int</span> z=0;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">while</span>(retour!=1){</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;r5-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a>;i++){</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      retour=<a class="code" href="couche1_8c.html#a1a6021fbd31ca2b308d61050416ab520">affichageBlockDecimal</a>(r5,i,z,stdout);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">if</span>(retour){</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">return</span>(retour);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      printf(<span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    z=z+4;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="couche2_8h.html#abc2b7fd9807ede9a34e0d2bea6e9521c">  194</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="couche2_8c.html#abc2b7fd9807ede9a34e0d2bea6e9521c">cmd_test1</a>(<a class="code" href="structvirtual__disk__s.html">virtual_disk_t</a> *r5){</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buffer[256];</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <a class="code" href="couche2_8c.html#a5e216cfa058baf4a67b6fc96773fe095">afficher_raid_decimal</a>(r5);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;256;i++){</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    buffer[i]=i;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <a class="code" href="couche2_8c.html#a7ba1127dd9f6b03cbef1c8974790d3c6">write_chunk</a>(r5,buffer,256,0);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  printf(<span class="stringliteral">&quot;\n\n&quot;</span>);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="couche2_8c.html#a37df3c8400bc0d4673471a52757d023a">afficher_raid_hexa</a>(r5);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;}</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="couche2_8h.html#aea9498cb46077bb21181922c96e8329f">  211</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="couche2_8c.html#aea9498cb46077bb21181922c96e8329f">read_stripe</a>(<a class="code" href="structvirtual__disk__s.html">virtual_disk_t</a> *r5, <a class="code" href="structstripe__s.html">stripe_t</a> *lire, <a class="code" href="raid__defines_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> pos){</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordtype">int</span> retour=0;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;r5-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a>;i++){</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    retour=<a class="code" href="couche1_8c.html#a4ba30a1143e543d465725eb0f151c6a2">read_block</a>(r5, &amp;(lire-&gt;<a class="code" href="structstripe__s.html#a16ff6d534dd4944c7fc544e4247e5ff1">stripe</a>[i]), pos, i);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">if</span>(retour){</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      printf(<span class="stringliteral">&quot;Erreur lecture , arrêt\n&quot;</span>);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  }</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;}</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="couche2_8c.html#a2c76b4c3607585f36f7e7653fb96d633">  228</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="couche2_8c.html#a2c76b4c3607585f36f7e7653fb96d633">cmd_test2</a>(<a class="code" href="structvirtual__disk__s.html">virtual_disk_t</a> *r5){</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buffer[256];</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <a class="code" href="couche2_8c.html#a37df3c8400bc0d4673471a52757d023a">afficher_raid_hexa</a>(r5);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <a class="code" href="couche2_8c.html#a1868b67f893921ee137623a23e4b6dd8">read_chunk</a>(r5,0,48);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  printf(<span class="stringliteral">&quot;\n\n&quot;</span>);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <a class="code" href="couche1_8c.html#a0f31c284e3b9461448ae2c5393a4c53f">turn_off_disk_raid5</a>(r5);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;}</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="couche2_8c.html#a1365b1597af91528776b50b5bc418a08">  242</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="couche2_8c.html#a1365b1597af91528776b50b5bc418a08">compute_num_bande</a>(<a class="code" href="structvirtual__disk__s.html">virtual_disk_t</a> *r5,<span class="keywordtype">int</span> nbloc){</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordflow">return</span> nbloc/r5-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;}</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="couche2_8h.html#a1868b67f893921ee137623a23e4b6dd8">  251</a></span>&#160;<span class="keywordtype">char</span> *<a class="code" href="couche2_8c.html#a1868b67f893921ee137623a23e4b6dd8">read_chunk</a>(<a class="code" href="structvirtual__disk__s.html">virtual_disk_t</a> *r5, <a class="code" href="raid__defines_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> start_block, <span class="keywordtype">int</span> n){</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <a class="code" href="raid__defines_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> nbBlocks = <a class="code" href="couche1_8c.html#a9cd7d6dccecc07ca1b67fd05c7928ee3">compute_nblock</a>(n);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buffer=malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)*n);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordtype">int</span> indice_buffer=0;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordtype">int</span> current=start_block;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordtype">int</span> nbBlocksLus = 0;              <span class="comment">/*Nombre de Blocks effectivement lus (sans lire les blocs de parité)*/</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <a class="code" href="structblock__s.html">block_t</a> *blc=malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structblock__s.html">block_s</a>));</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  printf(<span class="stringliteral">&quot;Lecture de chunk : [start]:%d ,[end]:%d ,[size]:%d\n&quot;</span>,start_block,start_block+n,<a class="code" href="couche1_8c.html#a9cd7d6dccecc07ca1b67fd05c7928ee3">compute_nblock</a>(n));</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordflow">while</span>((<a class="code" href="raid__defines_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>) nbBlocksLus&lt;nbBlocks){</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    printf(<span class="stringliteral">&quot;\nCurrent block :%d\n&quot;</span>,current);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">if</span>(current%(r5-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a>)!=<a class="code" href="couche2_8c.html#a70860f329dcd21100a6648089f864ed0">compute_parity_index</a>(r5, <a class="code" href="couche2_8c.html#a1365b1597af91528776b50b5bc418a08">compute_num_bande</a>(r5,current))){</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      printf(<span class="stringliteral">&quot;Reading position %d at disk %d\n&quot;</span>,(current/4)*4,current%r5-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a>);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <a class="code" href="couche1_8c.html#a4ba30a1143e543d465725eb0f151c6a2">read_block</a>(r5,blc,(current/4)*4,current%r5-&gt;<a class="code" href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">ndisk</a>);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="raid__defines_8h.html#ad51ded0bbd705f02f73fc60c0b721ced">BLOCK_SIZE</a>; i++){</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        buffer[indice_buffer]=blc-&gt;<a class="code" href="structblock__s.html#aeb657a9749b851021c3ef39acaf7b252">data</a>[i];</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        printf(<span class="stringliteral">&quot;%d &quot;</span>,blc-&gt;<a class="code" href="structblock__s.html#aeb657a9749b851021c3ef39acaf7b252">data</a>[i]);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        indice_buffer=indice_buffer+1;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      nbBlocksLus++;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    current++;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  free(blc);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordflow">return</span> buffer;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;}</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="couche2_8h.html#a38818187df03f330b062dcc1b3cf78df">  278</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="couche2_8c.html#a38818187df03f330b062dcc1b3cf78df">couche2</a>(<span class="keywordtype">void</span>){</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">//couche1();</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="structvirtual__disk__s.html">virtual_disk_t</a> *r5d=malloc(<span class="keyword">sizeof</span>(<a class="code" href="structvirtual__disk__s.html">virtual_disk_t</a>));</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <a class="code" href="couche1_8c.html#a745e214ead4cfa64503c1be97c30d25a">init_disk_raid5</a>(<span class="stringliteral">&quot;./RAIDFILES&quot;</span>,r5d);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="code" href="couche2_8c.html#abc2b7fd9807ede9a34e0d2bea6e9521c">cmd_test1</a>(r5d);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  printf(<span class="stringliteral">&quot;\nCMD_TEST2\n&quot;</span>);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <a class="code" href="couche2_8c.html#a2c76b4c3607585f36f7e7653fb96d633">cmd_test2</a>(r5d);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div><div class="ttc" id="couche2_8c_html_a37df3c8400bc0d4673471a52757d023a"><div class="ttname"><a href="couche2_8c.html#a37df3c8400bc0d4673471a52757d023a">afficher_raid_hexa</a></div><div class="ttdeci">int afficher_raid_hexa(virtual_disk_t *r5)</div><div class="ttdef"><b>Definition:</b> <a href="couche2_8c_source.html#l00150">couche2.c:150</a></div></div>
<div class="ttc" id="structblock__s_html"><div class="ttname"><a href="structblock__s.html">block_s</a></div><div class="ttdef"><b>Definition:</b> <a href="raid__defines_8h_source.html#l00023">raid_defines.h:23</a></div></div>
<div class="ttc" id="couche2_8c_html_a1365b1597af91528776b50b5bc418a08"><div class="ttname"><a href="couche2_8c.html#a1365b1597af91528776b50b5bc418a08">compute_num_bande</a></div><div class="ttdeci">int compute_num_bande(virtual_disk_t *r5, int nbloc)</div><div class="ttdoc">Fonction retournant le num de la bande actuelle. </div><div class="ttdef"><b>Definition:</b> <a href="couche2_8c_source.html#l00242">couche2.c:242</a></div></div>
<div class="ttc" id="couche1_8c_html_a0f31c284e3b9461448ae2c5393a4c53f"><div class="ttname"><a href="couche1_8c.html#a0f31c284e3b9461448ae2c5393a4c53f">turn_off_disk_raid5</a></div><div class="ttdeci">void turn_off_disk_raid5(virtual_disk_t *r5Disk)</div><div class="ttdoc">Ferme les fichiers ouverts et sauvegarde le super block? </div><div class="ttdef"><b>Definition:</b> <a href="couche1_8c_source.html#l00066">couche1.c:66</a></div></div>
<div class="ttc" id="couche2_8c_html_a5033c8eea4a4da6a76284e361f13240d"><div class="ttname"><a href="couche2_8c.html#a5033c8eea4a4da6a76284e361f13240d">write_stripe</a></div><div class="ttdeci">void write_stripe(virtual_disk_t *r5, stripe_t *ecrire, uint pos)</div><div class="ttdoc">Ecrit une stripe a la position passée en argument sur le raid passé en argument. </div><div class="ttdef"><b>Definition:</b> <a href="couche2_8c_source.html#l00063">couche2.c:63</a></div></div>
<div class="ttc" id="couche2_8c_html_ab6170c9cc6975d296a0bccfea207d415"><div class="ttname"><a href="couche2_8c.html#ab6170c9cc6975d296a0bccfea207d415">init_bande</a></div><div class="ttdeci">stripe_t * init_bande(virtual_disk_t *r5)</div><div class="ttdef"><b>Definition:</b> <a href="couche2_8c_source.html#l00070">couche2.c:70</a></div></div>
<div class="ttc" id="couche1_8c_html_a4ba30a1143e543d465725eb0f151c6a2"><div class="ttname"><a href="couche1_8c.html#a4ba30a1143e543d465725eb0f151c6a2">read_block</a></div><div class="ttdeci">int read_block(virtual_disk_t *RAID5, block_t *recup, uint pos, int idDisk)</div><div class="ttdoc">Lit un bloc à la position pos sur le disque. </div><div class="ttdef"><b>Definition:</b> <a href="couche1_8c_source.html#l00130">couche1.c:130</a></div></div>
<div class="ttc" id="structblock__s_html_aeb657a9749b851021c3ef39acaf7b252"><div class="ttname"><a href="structblock__s.html#aeb657a9749b851021c3ef39acaf7b252">block_s::data</a></div><div class="ttdeci">uchar data[BLOCK_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="raid__defines_8h_source.html#l00024">raid_defines.h:24</a></div></div>
<div class="ttc" id="structstripe__s_html"><div class="ttname"><a href="structstripe__s.html">stripe_s</a></div><div class="ttdef"><b>Definition:</b> <a href="raid__defines_8h_source.html#l00056">raid_defines.h:56</a></div></div>
<div class="ttc" id="couche2_8c_html_abc2b7fd9807ede9a34e0d2bea6e9521c"><div class="ttname"><a href="couche2_8c.html#abc2b7fd9807ede9a34e0d2bea6e9521c">cmd_test1</a></div><div class="ttdeci">void cmd_test1(virtual_disk_t *r5)</div><div class="ttdoc">fonction de test pour write_chunk </div><div class="ttdef"><b>Definition:</b> <a href="couche2_8c_source.html#l00194">couche2.c:194</a></div></div>
<div class="ttc" id="couche2_8h_html"><div class="ttname"><a href="couche2_8h.html">couche2.h</a></div></div>
<div class="ttc" id="couche2_8c_html_a9e6de3169d502aae6d8117e1e6ab03a0"><div class="ttname"><a href="couche2_8c.html#a9e6de3169d502aae6d8117e1e6ab03a0">compute_parity</a></div><div class="ttdeci">block_t compute_parity(virtual_disk_t *r5, stripe_t *tocompute, int indice_parite)</div><div class="ttdoc">Calcule le bloc de parité d&amp;#39;une stripe. </div><div class="ttdef"><b>Definition:</b> <a href="couche2_8c_source.html#l00035">couche2.c:35</a></div></div>
<div class="ttc" id="couche1_8h_html"><div class="ttname"><a href="couche1_8h.html">couche1.h</a></div></div>
<div class="ttc" id="couche2_8c_html_a2c76b4c3607585f36f7e7653fb96d633"><div class="ttname"><a href="couche2_8c.html#a2c76b4c3607585f36f7e7653fb96d633">cmd_test2</a></div><div class="ttdeci">void cmd_test2(virtual_disk_t *r5)</div><div class="ttdoc">Fonction de test pour read_chunk. </div><div class="ttdef"><b>Definition:</b> <a href="couche2_8c_source.html#l00228">couche2.c:228</a></div></div>
<div class="ttc" id="raid__defines_8h_html_ad51ded0bbd705f02f73fc60c0b721ced"><div class="ttname"><a href="raid__defines_8h.html#ad51ded0bbd705f02f73fc60c0b721ced">BLOCK_SIZE</a></div><div class="ttdeci">#define BLOCK_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="raid__defines_8h_source.html#l00007">raid_defines.h:7</a></div></div>
<div class="ttc" id="couche2_8c_html_a3e5eab04f9ea03705105756c7b8c0782"><div class="ttname"><a href="couche2_8c.html#a3e5eab04f9ea03705105756c7b8c0782">compute_nstripe</a></div><div class="ttdeci">int compute_nstripe(virtual_disk_t *r5Disk, int nblocks)</div><div class="ttdoc">Retourne le nombre de bandes necessaires pour écrire n blocs. </div><div class="ttdef"><b>Definition:</b> <a href="couche2_8c_source.html#l00023">couche2.c:23</a></div></div>
<div class="ttc" id="couche1_8c_html_a745e214ead4cfa64503c1be97c30d25a"><div class="ttname"><a href="couche1_8c.html#a745e214ead4cfa64503c1be97c30d25a">init_disk_raid5</a></div><div class="ttdeci">void init_disk_raid5(const char *repertoire, virtual_disk_t *r5Disk)</div><div class="ttdoc">Initialise la variable globale r5Disk. </div><div class="ttdef"><b>Definition:</b> <a href="couche1_8c_source.html#l00044">couche1.c:44</a></div></div>
<div class="ttc" id="structstripe__s_html_a076c8e8b7f7acccc46cd356bd8776b26"><div class="ttname"><a href="structstripe__s.html#a076c8e8b7f7acccc46cd356bd8776b26">stripe_s::nblocks</a></div><div class="ttdeci">int nblocks</div><div class="ttdef"><b>Definition:</b> <a href="raid__defines_8h_source.html#l00058">raid_defines.h:58</a></div></div>
<div class="ttc" id="couche2_8c_html_a5e216cfa058baf4a67b6fc96773fe095"><div class="ttname"><a href="couche2_8c.html#a5e216cfa058baf4a67b6fc96773fe095">afficher_raid_decimal</a></div><div class="ttdeci">int afficher_raid_decimal(virtual_disk_t *r5)</div><div class="ttdoc">affiche les disques du raid en valeurs décimales </div><div class="ttdef"><b>Definition:</b> <a href="couche2_8c_source.html#l00172">couche2.c:172</a></div></div>
<div class="ttc" id="structstripe__s_html_a16ff6d534dd4944c7fc544e4247e5ff1"><div class="ttname"><a href="structstripe__s.html#a16ff6d534dd4944c7fc544e4247e5ff1">stripe_s::stripe</a></div><div class="ttdeci">block_t * stripe</div><div class="ttdef"><b>Definition:</b> <a href="raid__defines_8h_source.html#l00059">raid_defines.h:59</a></div></div>
<div class="ttc" id="couche2_8c_html_a1868b67f893921ee137623a23e4b6dd8"><div class="ttname"><a href="couche2_8c.html#a1868b67f893921ee137623a23e4b6dd8">read_chunk</a></div><div class="ttdeci">char * read_chunk(virtual_disk_t *r5, uint start_block, int n)</div><div class="ttdoc">Fonction de lecture de tableau de char. </div><div class="ttdef"><b>Definition:</b> <a href="couche2_8c_source.html#l00251">couche2.c:251</a></div></div>
<div class="ttc" id="couche1_8c_html_a1fc20a5afdea4eec626e52a499ff46cd"><div class="ttname"><a href="couche1_8c.html#a1fc20a5afdea4eec626e52a499ff46cd">octetsToHexa</a></div><div class="ttdeci">void octetsToHexa(block_t monBloc, char *nbHexa)</div><div class="ttdoc">prend un tableau de 4 octets (char) et le transforme en Hexadecimal assert(monBloc[i]&lt;256); ...</div><div class="ttdef"><b>Definition:</b> <a href="couche1_8c_source.html#l00192">couche1.c:192</a></div></div>
<div class="ttc" id="couche2_8c_html_adf66b9197c93775a6c1dba723ba92a07"><div class="ttname"><a href="couche2_8c.html#adf66b9197c93775a6c1dba723ba92a07">delete_bande</a></div><div class="ttdeci">void delete_bande(stripe_t **bande)</div><div class="ttdoc">Libere la mémoir réservée par une bande. </div><div class="ttdef"><b>Definition:</b> <a href="couche2_8c_source.html#l00082">couche2.c:82</a></div></div>
<div class="ttc" id="couche2_8c_html_a7ba1127dd9f6b03cbef1c8974790d3c6"><div class="ttname"><a href="couche2_8c.html#a7ba1127dd9f6b03cbef1c8974790d3c6">write_chunk</a></div><div class="ttdeci">void write_chunk(virtual_disk_t *r5, char *buffer, int n, uint startBlock)</div><div class="ttdoc">Ecrit une stripe a la position passée en argument sur le raid passé en argument. </div><div class="ttdef"><b>Definition:</b> <a href="couche2_8c_source.html#l00112">couche2.c:112</a></div></div>
<div class="ttc" id="couche1_8c_html_adb4607cf11ffed5c89fc0f4682bf6079"><div class="ttname"><a href="couche1_8c.html#adb4607cf11ffed5c89fc0f4682bf6079">write_block</a></div><div class="ttdeci">void write_block(virtual_disk_t *RAID5, block_t *entrant, uint pos, int idDisk)</div><div class="ttdoc">Ecrit un bloc à la position pos sur le disque. </div><div class="ttdef"><b>Definition:</b> <a href="couche1_8c_source.html#l00112">couche1.c:112</a></div></div>
<div class="ttc" id="structvirtual__disk__s_html"><div class="ttname"><a href="structvirtual__disk__s.html">virtual_disk_s</a></div><div class="ttdef"><b>Definition:</b> <a href="raid__defines_8h_source.html#l00046">raid_defines.h:46</a></div></div>
<div class="ttc" id="structvirtual__disk__s_html_a879b20de8088f4342835d5fb3feb1141"><div class="ttname"><a href="structvirtual__disk__s.html#a879b20de8088f4342835d5fb3feb1141">virtual_disk_s::ndisk</a></div><div class="ttdeci">int ndisk</div><div class="ttdef"><b>Definition:</b> <a href="raid__defines_8h_source.html#l00050">raid_defines.h:50</a></div></div>
<div class="ttc" id="couche2_8c_html_a70860f329dcd21100a6648089f864ed0"><div class="ttname"><a href="couche2_8c.html#a70860f329dcd21100a6648089f864ed0">compute_parity_index</a></div><div class="ttdeci">int compute_parity_index(virtual_disk_t *r5, int numbd)</div><div class="ttdoc">Calcule la position du block de parité d&amp;#39;une stripe. </div><div class="ttdef"><b>Definition:</b> <a href="couche2_8c_source.html#l00050">couche2.c:50</a></div></div>
<div class="ttc" id="couche1_8c_html_a9cd7d6dccecc07ca1b67fd05c7928ee3"><div class="ttname"><a href="couche1_8c.html#a9cd7d6dccecc07ca1b67fd05c7928ee3">compute_nblock</a></div><div class="ttdeci">int compute_nblock(int n)</div><div class="ttdoc">calcule le nombre de blocs pour coder &quot;n&quot; octets </div><div class="ttdef"><b>Definition:</b> <a href="couche1_8c_source.html#l00093">couche1.c:93</a></div></div>
<div class="ttc" id="couche1_8c_html_ae6cedff3423d9b8afe126d3f298576ee"><div class="ttname"><a href="couche1_8c.html#ae6cedff3423d9b8afe126d3f298576ee">affichageBlockHexa</a></div><div class="ttdeci">int affichageBlockHexa(virtual_disk_t *RAID5, int idDisk, uint pos, FILE *output)</div><div class="ttdoc">affiche un bloc de donnees en hexadecimal </div><div class="ttdef"><b>Definition:</b> <a href="couche1_8c_source.html#l00274">couche1.c:274</a></div></div>
<div class="ttc" id="couche1_8c_html_a1a6021fbd31ca2b308d61050416ab520"><div class="ttname"><a href="couche1_8c.html#a1a6021fbd31ca2b308d61050416ab520">affichageBlockDecimal</a></div><div class="ttdeci">int affichageBlockDecimal(virtual_disk_t *RAID5, int idDisk, uint pos, FILE *output)</div><div class="ttdef"><b>Definition:</b> <a href="couche1_8c_source.html#l00291">couche1.c:291</a></div></div>
<div class="ttc" id="couche2_8c_html_a2fa67e5d44f8746a06cc56ef2876c45e"><div class="ttname"><a href="couche2_8c.html#a2fa67e5d44f8746a06cc56ef2876c45e">print_stripe</a></div><div class="ttdeci">void print_stripe(virtual_disk_t *r5, stripe_t *stripe)</div><div class="ttdoc">Affiche une bande. </div><div class="ttdef"><b>Definition:</b> <a href="couche2_8c_source.html#l00093">couche2.c:93</a></div></div>
<div class="ttc" id="raid__defines_8h_html_a91ad9478d81a7aaf2593e8d9c3d06a14"><div class="ttname"><a href="raid__defines_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a></div><div class="ttdeci">unsigned int uint</div><div class="ttdef"><b>Definition:</b> <a href="raid__defines_8h_source.html#l00016">raid_defines.h:16</a></div></div>
<div class="ttc" id="couche2_8c_html_a38818187df03f330b062dcc1b3cf78df"><div class="ttname"><a href="couche2_8c.html#a38818187df03f330b062dcc1b3cf78df">couche2</a></div><div class="ttdeci">int couche2(void)</div><div class="ttdef"><b>Definition:</b> <a href="couche2_8c_source.html#l00278">couche2.c:278</a></div></div>
<div class="ttc" id="couche2_8c_html_aea9498cb46077bb21181922c96e8329f"><div class="ttname"><a href="couche2_8c.html#aea9498cb46077bb21181922c96e8329f">read_stripe</a></div><div class="ttdeci">int read_stripe(virtual_disk_t *r5, stripe_t *lire, uint pos)</div><div class="ttdoc">Lis une bande a partir de la position passée en parametre. </div><div class="ttdef"><b>Definition:</b> <a href="couche2_8c_source.html#l00211">couche2.c:211</a></div></div>
<div class="ttc" id="trash_8c_html_aa32bee7663041ae13a36afeae68a3f14"><div class="ttname"><a href="trash_8c.html#aa32bee7663041ae13a36afeae68a3f14">r5Disk</a></div><div class="ttdeci">r5Disk</div><div class="ttdef"><b>Definition:</b> <a href="trash_8c_source.html#l00108">trash.c:108</a></div></div>
<div class="ttc" id="couche1_8c_html_a69d295ba0ccd1a14fbc7ef4dd2c3a5c9"><div class="ttname"><a href="couche1_8c.html#a69d295ba0ccd1a14fbc7ef4dd2c3a5c9">xorbl</a></div><div class="ttdeci">void xorbl(block_t *xa, block_t *xb, block_t *destination)</div><div class="ttdef"><b>Definition:</b> <a href="couche1_8c_source.html#l00141">couche1.c:141</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
