<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.13">
  <compounddef id="couche2_8c" kind="file" language="C++">
    <compoundname>couche2.c</compoundname>
    <includes refid="couche1_8h" local="yes">couche1.h</includes>
    <includes refid="couche2_8h" local="yes">couche2.h</includes>
    <includes local="no">stdlib.h</includes>
    <includes local="no">math.h</includes>
    <incdepgraph>
      <node id="28">
        <label>couche2.c</label>
        <link refid="couche2_8c"/>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
      </node>
      <node id="32">
        <label>couche2.h</label>
        <link refid="couche2_8h"/>
        <childnode refid="29" relation="include">
        </childnode>
      </node>
      <node id="33">
        <label>stdlib.h</label>
      </node>
      <node id="30">
        <label>raid_defines.h</label>
        <link refid="raid__defines_8h"/>
        <childnode refid="31" relation="include">
        </childnode>
      </node>
      <node id="34">
        <label>math.h</label>
      </node>
      <node id="29">
        <label>couche1.h</label>
        <link refid="couche1_8h"/>
        <childnode refid="30" relation="include">
        </childnode>
      </node>
      <node id="31">
        <label>stdio.h</label>
      </node>
    </incdepgraph>
      <sectiondef kind="func">
      <memberdef kind="function" id="couche2_8c_1a3e5eab04f9ea03705105756c7b8c0782" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int compute_nstripe</definition>
        <argsstring>(virtual_disk_t *r5Disk, int nblocks)</argsstring>
        <name>compute_nstripe</name>
        <param>
          <type><ref refid="raid__defines_8h_1ab22cb9a2c3c081d95bd06c65d6716686" kindref="member">virtual_disk_t</ref> *</type>
          <declname>r5Disk</declname>
        </param>
        <param>
          <type>int</type>
          <declname>nblocks</declname>
        </param>
        <briefdescription>
<para>Retourne le nombre de bandes necessaires pour écrire n blocs. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername></parametername>
</parameternamelist>
<parameterdescription>
<para>Nombre de blocs (int) </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Nombre de bandes (int) </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="couche2.c" line="23" column="1" bodyfile="couche2.c" bodystart="23" bodyend="28"/>
        <references refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" compoundref="raid__defines_8h" startline="50">virtual_disk_s::ndisk</references>
        <referencedby refid="couche2_8h_1a7ba1127dd9f6b03cbef1c8974790d3c6" compoundref="couche2_8c" startline="112" endline="147">write_chunk</referencedby>
        <referencedby refid="couche3_8h_1a4655c5b4ff56a089ebb3d5436aa3109f" compoundref="couche3_8c" startline="57" endline="129">read_inodes_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="couche2_8c_1a9e6de3169d502aae6d8117e1e6ab03a0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="raid__defines_8h_1a9497df9c1d65b018066a9760da7be4e6" kindref="member">block_t</ref></type>
        <definition>block_t compute_parity</definition>
        <argsstring>(virtual_disk_t *r5, stripe_t *tocompute, int indice_parite)</argsstring>
        <name>compute_parity</name>
        <param>
          <type><ref refid="raid__defines_8h_1ab22cb9a2c3c081d95bd06c65d6716686" kindref="member">virtual_disk_t</ref> *</type>
          <declname>r5</declname>
        </param>
        <param>
          <type><ref refid="raid__defines_8h_1acfaa25ade17f36b058f738bded61819a" kindref="member">stripe_t</ref> *</type>
          <declname>tocompute</declname>
        </param>
        <param>
          <type>int</type>
          <declname>indice_parite</declname>
        </param>
        <briefdescription>
<para>Calcule le bloc de parité d&apos;une stripe. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername></parametername>
</parameternamelist>
<parameterdescription>
<para>virtual_disk_t *, stripe_t *,int </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>block_t </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="couche2.c" line="35" column="1" bodyfile="couche2.c" bodystart="35" bodyend="43"/>
        <references refid="structstripe__s_1a16ff6d534dd4944c7fc544e4247e5ff1" compoundref="raid__defines_8h" startline="59">stripe_s::stripe</references>
        <references refid="structstripe__s_1a076c8e8b7f7acccc46cd356bd8776b26" compoundref="raid__defines_8h" startline="58">stripe_s::nblocks</references>
        <references refid="couche1_8c_1a69d295ba0ccd1a14fbc7ef4dd2c3a5c9" compoundref="couche1_8c" startline="141" endline="145">xorbl</references>
        <referencedby refid="couche2_8h_1a7ba1127dd9f6b03cbef1c8974790d3c6" compoundref="couche2_8c" startline="112" endline="147">write_chunk</referencedby>
      </memberdef>
      <memberdef kind="function" id="couche2_8c_1a70860f329dcd21100a6648089f864ed0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int compute_parity_index</definition>
        <argsstring>(virtual_disk_t *r5, int numbd)</argsstring>
        <name>compute_parity_index</name>
        <param>
          <type><ref refid="raid__defines_8h_1ab22cb9a2c3c081d95bd06c65d6716686" kindref="member">virtual_disk_t</ref> *</type>
          <declname>r5</declname>
        </param>
        <param>
          <type>int</type>
          <declname>numbd</declname>
        </param>
        <briefdescription>
<para>Calcule la position du block de parité d&apos;une stripe. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername></parametername>
</parameternamelist>
<parameterdescription>
<para>virtual_disk_t , int numero de la bande dans la liste du raid </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>int </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="couche2.c" line="50" column="1" bodyfile="couche2.c" bodystart="50" bodyend="56"/>
        <references refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" compoundref="raid__defines_8h" startline="50">virtual_disk_s::ndisk</references>
        <referencedby refid="couche2_8h_1a7ba1127dd9f6b03cbef1c8974790d3c6" compoundref="couche2_8c" startline="112" endline="147">write_chunk</referencedby>
        <referencedby refid="couche2_8h_1a1868b67f893921ee137623a23e4b6dd8" compoundref="couche2_8c" startline="251" endline="275">read_chunk</referencedby>
        <referencedby refid="couche3_8h_1afb633869cb6423375c1b26936806d6e7" compoundref="couche3_8c" startline="137" endline="185">write_inodes_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="couche2_8c_1a5033c8eea4a4da6a76284e361f13240d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void write_stripe</definition>
        <argsstring>(virtual_disk_t *r5, stripe_t *ecrire, uint pos)</argsstring>
        <name>write_stripe</name>
        <param>
          <type><ref refid="raid__defines_8h_1ab22cb9a2c3c081d95bd06c65d6716686" kindref="member">virtual_disk_t</ref> *</type>
          <declname>r5</declname>
        </param>
        <param>
          <type><ref refid="raid__defines_8h_1acfaa25ade17f36b058f738bded61819a" kindref="member">stripe_t</ref> *</type>
          <declname>ecrire</declname>
        </param>
        <param>
          <type><ref refid="raid__defines_8h_1a91ad9478d81a7aaf2593e8d9c3d06a14" kindref="member">uint</ref></type>
          <declname>pos</declname>
        </param>
        <briefdescription>
<para>Ecrit une stripe a la position passée en argument sur le raid passé en argument. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername></parametername>
</parameternamelist>
<parameterdescription>
<para>virtual_disk_t ,stripe_t ,int </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>void </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="couche2.c" line="63" column="1" bodyfile="couche2.c" bodystart="63" bodyend="67"/>
        <references refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" compoundref="raid__defines_8h" startline="50">virtual_disk_s::ndisk</references>
        <references refid="couche1_8c_1adb4607cf11ffed5c89fc0f4682bf6079" compoundref="couche1_8c" startline="112" endline="118">write_block</references>
        <references refid="structstripe__s_1a16ff6d534dd4944c7fc544e4247e5ff1" compoundref="raid__defines_8h" startline="59">stripe_s::stripe</references>
        <referencedby refid="couche2_8h_1a7ba1127dd9f6b03cbef1c8974790d3c6" compoundref="couche2_8c" startline="112" endline="147">write_chunk</referencedby>
      </memberdef>
      <memberdef kind="function" id="couche2_8c_1ab6170c9cc6975d296a0bccfea207d415" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="raid__defines_8h_1acfaa25ade17f36b058f738bded61819a" kindref="member">stripe_t</ref> *</type>
        <definition>stripe_t* init_bande</definition>
        <argsstring>(virtual_disk_t *r5)</argsstring>
        <name>init_bande</name>
        <param>
          <type><ref refid="raid__defines_8h_1ab22cb9a2c3c081d95bd06c65d6716686" kindref="member">virtual_disk_t</ref> *</type>
          <declname>r5</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="couche2.c" line="70" column="1" bodyfile="couche2.c" bodystart="70" bodyend="75"/>
        <references refid="structstripe__s_1a076c8e8b7f7acccc46cd356bd8776b26" compoundref="raid__defines_8h" startline="58">stripe_s::nblocks</references>
        <references refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" compoundref="raid__defines_8h" startline="50">virtual_disk_s::ndisk</references>
        <references refid="structstripe__s_1a16ff6d534dd4944c7fc544e4247e5ff1" compoundref="raid__defines_8h" startline="59">stripe_s::stripe</references>
        <referencedby refid="couche2_8h_1a7ba1127dd9f6b03cbef1c8974790d3c6" compoundref="couche2_8c" startline="112" endline="147">write_chunk</referencedby>
        <referencedby refid="couche3_8h_1a4655c5b4ff56a089ebb3d5436aa3109f" compoundref="couche3_8c" startline="57" endline="129">read_inodes_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="couche2_8c_1adf66b9197c93775a6c1dba723ba92a07" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void delete_bande</definition>
        <argsstring>(stripe_t **bande)</argsstring>
        <name>delete_bande</name>
        <param>
          <type><ref refid="raid__defines_8h_1acfaa25ade17f36b058f738bded61819a" kindref="member">stripe_t</ref> **</type>
          <declname>bande</declname>
        </param>
        <briefdescription>
<para>Libere la mémoir réservée par une bande. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername></parametername>
</parameternamelist>
<parameterdescription>
<para>stripe_t * </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>void </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="couche2.c" line="82" column="1" bodyfile="couche2.c" bodystart="82" bodyend="86"/>
        <referencedby refid="couche2_8h_1a7ba1127dd9f6b03cbef1c8974790d3c6" compoundref="couche2_8c" startline="112" endline="147">write_chunk</referencedby>
        <referencedby refid="couche3_8h_1a4655c5b4ff56a089ebb3d5436aa3109f" compoundref="couche3_8c" startline="57" endline="129">read_inodes_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="couche2_8c_1a2fa67e5d44f8746a06cc56ef2876c45e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void print_stripe</definition>
        <argsstring>(virtual_disk_t *r5, stripe_t *stripe)</argsstring>
        <name>print_stripe</name>
        <param>
          <type><ref refid="raid__defines_8h_1ab22cb9a2c3c081d95bd06c65d6716686" kindref="member">virtual_disk_t</ref> *</type>
          <declname>r5</declname>
        </param>
        <param>
          <type><ref refid="raid__defines_8h_1acfaa25ade17f36b058f738bded61819a" kindref="member">stripe_t</ref> *</type>
          <declname>stripe</declname>
        </param>
        <briefdescription>
<para>Affiche une bande. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername></parametername>
</parameternamelist>
<parameterdescription>
<para>virtual_disk_t ,stripe_t </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>void </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="couche2.c" line="93" column="1" bodyfile="couche2.c" bodystart="93" bodyend="105"/>
        <references refid="raid__defines_8h_1ad51ded0bbd705f02f73fc60c0b721ced" compoundref="raid__defines_8h" startline="7">BLOCK_SIZE</references>
        <references refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" compoundref="raid__defines_8h" startline="50">virtual_disk_s::ndisk</references>
        <references refid="structstripe__s_1a16ff6d534dd4944c7fc544e4247e5ff1" compoundref="raid__defines_8h" startline="59">stripe_s::stripe</references>
        <references refid="couche1_8c_1a1fc20a5afdea4eec626e52a499ff46cd" compoundref="couche1_8c" startline="192" endline="200">octetsToHexa</references>
      </memberdef>
      <memberdef kind="function" id="couche2_8c_1a7ba1127dd9f6b03cbef1c8974790d3c6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void write_chunk</definition>
        <argsstring>(virtual_disk_t *r5, char *buffer, int n, uint startBlock)</argsstring>
        <name>write_chunk</name>
        <param>
          <type><ref refid="raid__defines_8h_1ab22cb9a2c3c081d95bd06c65d6716686" kindref="member">virtual_disk_t</ref> *</type>
          <declname>r5</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>buffer</declname>
        </param>
        <param>
          <type>int</type>
          <declname>n</declname>
        </param>
        <param>
          <type><ref refid="raid__defines_8h_1a91ad9478d81a7aaf2593e8d9c3d06a14" kindref="member">uint</ref></type>
          <declname>startBlock</declname>
        </param>
        <briefdescription>
<para>Ecrit une stripe a la position passée en argument sur le raid passé en argument. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername></parametername>
</parameternamelist>
<parameterdescription>
<para>virtual_disk_t ,stripe_t ,int </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>void </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="couche2.c" line="112" column="1" bodyfile="couche2.c" bodystart="112" bodyend="147"/>
        <references refid="couche1_8c_1a9cd7d6dccecc07ca1b67fd05c7928ee3" compoundref="couche1_8c" startline="93" endline="102">compute_nblock</references>
        <references refid="couche2_8c_1a3e5eab04f9ea03705105756c7b8c0782" compoundref="couche2_8c" startline="23" endline="28">compute_nstripe</references>
        <references refid="raid__defines_8h_1ad51ded0bbd705f02f73fc60c0b721ced" compoundref="raid__defines_8h" startline="7">BLOCK_SIZE</references>
        <references refid="structblock__s_1aeb657a9749b851021c3ef39acaf7b252" compoundref="raid__defines_8h" startline="24">block_s::data</references>
        <references refid="couche2_8c_1ab6170c9cc6975d296a0bccfea207d415" compoundref="couche2_8c" startline="70" endline="75">init_bande</references>
        <references refid="couche2_8c_1a70860f329dcd21100a6648089f864ed0" compoundref="couche2_8c" startline="50" endline="56">compute_parity_index</references>
        <references refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" compoundref="raid__defines_8h" startline="50">virtual_disk_s::ndisk</references>
        <references refid="structstripe__s_1a16ff6d534dd4944c7fc544e4247e5ff1" compoundref="raid__defines_8h" startline="59">stripe_s::stripe</references>
        <references refid="couche2_8c_1a9e6de3169d502aae6d8117e1e6ab03a0" compoundref="couche2_8c" startline="35" endline="43">compute_parity</references>
        <references refid="couche2_8c_1a5033c8eea4a4da6a76284e361f13240d" compoundref="couche2_8c" startline="63" endline="67">write_stripe</references>
        <references refid="couche2_8c_1adf66b9197c93775a6c1dba723ba92a07" compoundref="couche2_8c" startline="82" endline="86">delete_bande</references>
        <referencedby refid="couche2_8h_1abc2b7fd9807ede9a34e0d2bea6e9521c" compoundref="couche2_8c" startline="194" endline="203">cmd_test1</referencedby>
        <referencedby refid="couche3_8h_1afb633869cb6423375c1b26936806d6e7" compoundref="couche3_8c" startline="137" endline="185">write_inodes_table</referencedby>
        <referencedby refid="couche3_8h_1a380acc8c8a85a041ecae9a995cf0a490" compoundref="couche3_8c" startline="269" endline="313">write_super_block</referencedby>
      </memberdef>
      <memberdef kind="function" id="couche2_8c_1a37df3c8400bc0d4673471a52757d023a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int afficher_raid_hexa</definition>
        <argsstring>(virtual_disk_t *r5)</argsstring>
        <name>afficher_raid_hexa</name>
        <param>
          <type><ref refid="raid__defines_8h_1ab22cb9a2c3c081d95bd06c65d6716686" kindref="member">virtual_disk_t</ref> *</type>
          <declname>r5</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="couche2.c" line="150" column="1" bodyfile="couche2.c" bodystart="150" bodyend="165"/>
        <references refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" compoundref="raid__defines_8h" startline="50">virtual_disk_s::ndisk</references>
        <references refid="couche1_8c_1ae6cedff3423d9b8afe126d3f298576ee" compoundref="couche1_8c" startline="274" endline="289">affichageBlockHexa</references>
        <referencedby refid="couche2_8h_1abc2b7fd9807ede9a34e0d2bea6e9521c" compoundref="couche2_8c" startline="194" endline="203">cmd_test1</referencedby>
        <referencedby refid="couche2_8c_1a2c76b4c3607585f36f7e7653fb96d633" compoundref="couche2_8c" startline="228" endline="234">cmd_test2</referencedby>
      </memberdef>
      <memberdef kind="function" id="couche2_8c_1a5e216cfa058baf4a67b6fc96773fe095" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int afficher_raid_decimal</definition>
        <argsstring>(virtual_disk_t *r5)</argsstring>
        <name>afficher_raid_decimal</name>
        <param>
          <type><ref refid="raid__defines_8h_1ab22cb9a2c3c081d95bd06c65d6716686" kindref="member">virtual_disk_t</ref> *</type>
          <declname>r5</declname>
        </param>
        <briefdescription>
<para>affiche les disques du raid en valeurs décimales </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername></parametername>
</parameternamelist>
<parameterdescription>
<para>virtual_disk_t * </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>int </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="couche2.c" line="172" column="1" bodyfile="couche2.c" bodystart="172" bodyend="187"/>
        <references refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" compoundref="raid__defines_8h" startline="50">virtual_disk_s::ndisk</references>
        <references refid="couche1_8c_1a1a6021fbd31ca2b308d61050416ab520" compoundref="couche1_8c" startline="291" endline="309">affichageBlockDecimal</references>
        <referencedby refid="couche2_8h_1abc2b7fd9807ede9a34e0d2bea6e9521c" compoundref="couche2_8c" startline="194" endline="203">cmd_test1</referencedby>
      </memberdef>
      <memberdef kind="function" id="couche2_8c_1abc2b7fd9807ede9a34e0d2bea6e9521c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void cmd_test1</definition>
        <argsstring>(virtual_disk_t *r5)</argsstring>
        <name>cmd_test1</name>
        <param>
          <type><ref refid="raid__defines_8h_1ab22cb9a2c3c081d95bd06c65d6716686" kindref="member">virtual_disk_t</ref> *</type>
          <declname>r5</declname>
        </param>
        <briefdescription>
<para>fonction de test pour write_chunk </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>virtual_disk_t</parametername>
</parameternamelist>
<parameterdescription>
<para>* </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="couche2.c" line="194" column="1" bodyfile="couche2.c" bodystart="194" bodyend="203"/>
        <references refid="couche2_8c_1a5e216cfa058baf4a67b6fc96773fe095" compoundref="couche2_8c" startline="172" endline="187">afficher_raid_decimal</references>
        <references refid="couche2_8c_1a7ba1127dd9f6b03cbef1c8974790d3c6" compoundref="couche2_8c" startline="112" endline="147">write_chunk</references>
        <references refid="couche2_8c_1a37df3c8400bc0d4673471a52757d023a" compoundref="couche2_8c" startline="150" endline="165">afficher_raid_hexa</references>
        <referencedby refid="couche2_8h_1a38818187df03f330b062dcc1b3cf78df" compoundref="couche2_8c" startline="278" endline="286">couche2</referencedby>
      </memberdef>
      <memberdef kind="function" id="couche2_8c_1aea9498cb46077bb21181922c96e8329f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int read_stripe</definition>
        <argsstring>(virtual_disk_t *r5, stripe_t *lire, uint pos)</argsstring>
        <name>read_stripe</name>
        <param>
          <type><ref refid="raid__defines_8h_1ab22cb9a2c3c081d95bd06c65d6716686" kindref="member">virtual_disk_t</ref> *</type>
          <declname>r5</declname>
        </param>
        <param>
          <type><ref refid="raid__defines_8h_1acfaa25ade17f36b058f738bded61819a" kindref="member">stripe_t</ref> *</type>
          <declname>lire</declname>
        </param>
        <param>
          <type><ref refid="raid__defines_8h_1a91ad9478d81a7aaf2593e8d9c3d06a14" kindref="member">uint</ref></type>
          <declname>pos</declname>
        </param>
        <briefdescription>
<para>Lis une bande a partir de la position passée en parametre. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername></parametername>
</parameternamelist>
<parameterdescription>
<para>virtual_disk_t *,stripe_t *, uint </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>int </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="couche2.c" line="211" column="1" bodyfile="couche2.c" bodystart="211" bodyend="221"/>
        <references refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" compoundref="raid__defines_8h" startline="50">virtual_disk_s::ndisk</references>
        <references refid="couche1_8c_1a4ba30a1143e543d465725eb0f151c6a2" compoundref="couche1_8c" startline="130" endline="138">read_block</references>
        <references refid="structstripe__s_1a16ff6d534dd4944c7fc544e4247e5ff1" compoundref="raid__defines_8h" startline="59">stripe_s::stripe</references>
        <referencedby refid="couche3_8h_1a846a550008b03ec52ba64c30d614d08b" compoundref="couche3_8c" startline="25" endline="49">read_super_block</referencedby>
        <referencedby refid="couche3_8h_1a4655c5b4ff56a089ebb3d5436aa3109f" compoundref="couche3_8c" startline="57" endline="129">read_inodes_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="couche2_8c_1a2c76b4c3607585f36f7e7653fb96d633" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void cmd_test2</definition>
        <argsstring>(virtual_disk_t *r5)</argsstring>
        <name>cmd_test2</name>
        <param>
          <type><ref refid="raid__defines_8h_1ab22cb9a2c3c081d95bd06c65d6716686" kindref="member">virtual_disk_t</ref> *</type>
          <declname>r5</declname>
        </param>
        <briefdescription>
<para>Fonction de test pour read_chunk. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername></parametername>
</parameternamelist>
<parameterdescription>
<para>virtual_disk_t * </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>void </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="couche2.c" line="228" column="1" bodyfile="couche2.c" bodystart="228" bodyend="234"/>
        <references refid="couche2_8c_1a37df3c8400bc0d4673471a52757d023a" compoundref="couche2_8c" startline="150" endline="165">afficher_raid_hexa</references>
        <references refid="couche2_8c_1a1868b67f893921ee137623a23e4b6dd8" compoundref="couche2_8c" startline="251" endline="275">read_chunk</references>
        <references refid="couche1_8c_1a0f31c284e3b9461448ae2c5393a4c53f" compoundref="couche1_8c" startline="66" endline="72">turn_off_disk_raid5</references>
        <referencedby refid="couche2_8h_1a38818187df03f330b062dcc1b3cf78df" compoundref="couche2_8c" startline="278" endline="286">couche2</referencedby>
      </memberdef>
      <memberdef kind="function" id="couche2_8c_1a1365b1597af91528776b50b5bc418a08" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int compute_num_bande</definition>
        <argsstring>(virtual_disk_t *r5, int nbloc)</argsstring>
        <name>compute_num_bande</name>
        <param>
          <type><ref refid="raid__defines_8h_1ab22cb9a2c3c081d95bd06c65d6716686" kindref="member">virtual_disk_t</ref> *</type>
          <declname>r5</declname>
        </param>
        <param>
          <type>int</type>
          <declname>nbloc</declname>
        </param>
        <briefdescription>
<para>Fonction retournant le num de la bande actuelle. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername></parametername>
</parameternamelist>
<parameterdescription>
<para>virtual_disk_t * le systeme </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername></parametername>
</parameternamelist>
<parameterdescription>
<para>int le numéro du block actuel </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>: int le numero de la bande </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="couche2.c" line="242" column="1" bodyfile="couche2.c" bodystart="242" bodyend="244"/>
        <references refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" compoundref="raid__defines_8h" startline="50">virtual_disk_s::ndisk</references>
        <referencedby refid="couche2_8h_1a1868b67f893921ee137623a23e4b6dd8" compoundref="couche2_8c" startline="251" endline="275">read_chunk</referencedby>
      </memberdef>
      <memberdef kind="function" id="couche2_8c_1a1868b67f893921ee137623a23e4b6dd8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>char *</type>
        <definition>char* read_chunk</definition>
        <argsstring>(virtual_disk_t *r5, uint start_block, int n)</argsstring>
        <name>read_chunk</name>
        <param>
          <type><ref refid="raid__defines_8h_1ab22cb9a2c3c081d95bd06c65d6716686" kindref="member">virtual_disk_t</ref> *</type>
          <declname>r5</declname>
        </param>
        <param>
          <type><ref refid="raid__defines_8h_1a91ad9478d81a7aaf2593e8d9c3d06a14" kindref="member">uint</ref></type>
          <declname>start_block</declname>
        </param>
        <param>
          <type>int</type>
          <declname>n</declname>
        </param>
        <briefdescription>
<para>Fonction de lecture de tableau de char. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername></parametername>
</parameternamelist>
<parameterdescription>
<para>virtual_disk_t * , uint , int </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>char * </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="couche2.c" line="251" column="1" bodyfile="couche2.c" bodystart="251" bodyend="275"/>
        <references refid="couche1_8c_1a9cd7d6dccecc07ca1b67fd05c7928ee3" compoundref="couche1_8c" startline="93" endline="102">compute_nblock</references>
        <references refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" compoundref="raid__defines_8h" startline="50">virtual_disk_s::ndisk</references>
        <references refid="couche2_8c_1a70860f329dcd21100a6648089f864ed0" compoundref="couche2_8c" startline="50" endline="56">compute_parity_index</references>
        <references refid="couche2_8c_1a1365b1597af91528776b50b5bc418a08" compoundref="couche2_8c" startline="242" endline="244">compute_num_bande</references>
        <references refid="couche1_8c_1a4ba30a1143e543d465725eb0f151c6a2" compoundref="couche1_8c" startline="130" endline="138">read_block</references>
        <references refid="raid__defines_8h_1ad51ded0bbd705f02f73fc60c0b721ced" compoundref="raid__defines_8h" startline="7">BLOCK_SIZE</references>
        <references refid="structblock__s_1aeb657a9749b851021c3ef39acaf7b252" compoundref="raid__defines_8h" startline="24">block_s::data</references>
        <referencedby refid="couche2_8c_1a2c76b4c3607585f36f7e7653fb96d633" compoundref="couche2_8c" startline="228" endline="234">cmd_test2</referencedby>
      </memberdef>
      <memberdef kind="function" id="couche2_8c_1a38818187df03f330b062dcc1b3cf78df" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int couche2</definition>
        <argsstring>(void)</argsstring>
        <name>couche2</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="couche2.c" line="278" column="1" bodyfile="couche2.c" bodystart="278" bodyend="286"/>
        <references refid="couche1_8c_1a745e214ead4cfa64503c1be97c30d25a" compoundref="couche1_8c" startline="44" endline="56">init_disk_raid5</references>
        <references refid="couche2_8c_1abc2b7fd9807ede9a34e0d2bea6e9521c" compoundref="couche2_8c" startline="194" endline="203">cmd_test1</references>
        <references refid="couche2_8c_1a2c76b4c3607585f36f7e7653fb96d633" compoundref="couche2_8c" startline="228" endline="234">cmd_test2</references>
      </memberdef>
      </sectiondef>
    <briefdescription>
<para>Programme couche2 du raid5. </para>    </briefdescription>
    <detaileddescription>
<para><simplesect kind="author"><para>Groupe14 </para></simplesect>
<simplesect kind="version"><para>0.1 </para></simplesect>
<simplesect kind="date"><para>24 fevrier 2019</para></simplesect>
Programme de la couche 2 du raid5. </para>    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#include<sp/>&quot;<ref refid="couche1_8h" kindref="compound">couche1.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="couche2_8h" kindref="compound">couche2.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdlib.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;math.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight></codeline>
<codeline lineno="23" refid="couche2_8h_1a3e5eab04f9ea03705105756c7b8c0782" refkind="member"><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="couche2_8c_1a3e5eab04f9ea03705105756c7b8c0782" kindref="member">compute_nstripe</ref>(<ref refid="structvirtual__disk__s" kindref="compound">virtual_disk_t</ref><sp/>*<ref refid="trash_8c_1aa32bee7663041ae13a36afeae68a3f14" kindref="member">r5Disk</ref>,</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nblocks){</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//Dans<sp/>le<sp/>cas<sp/>du<sp/>raid5<sp/>,<sp/>une<sp/>bande<sp/>=<sp/>n-1<sp/>blocs<sp/>avec<sp/>n<sp/>le<sp/>nombre<sp/>de<sp/>disques</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//une<sp/>bande<sp/>=<sp/>n<sp/>blocs,<sp/>avec<sp/>n-1<sp/>blocs<sp/>de<sp/>données<sp/>et<sp/>1<sp/>bloc<sp/>de<sp/>parité</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//Une<sp/>bande<sp/>contient<sp/>donc<sp/>n-1<sp/>bloc<sp/>des<sp/>n<sp/>blocs<sp/>de<sp/>données<sp/>à<sp/>stocker</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((nblocks/((r5Disk-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref>)-1))+(nblocks%((r5Disk-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref>)-1)<sp/>==<sp/>0));</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/>}</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="35" refid="couche2_8h_1a9e6de3169d502aae6d8117e1e6ab03a0" refkind="member"><highlight class="normal"><ref refid="structblock__s" kindref="compound">block_t</ref><sp/><ref refid="couche2_8c_1a9e6de3169d502aae6d8117e1e6ab03a0" kindref="member">compute_parity</ref>(<ref refid="structvirtual__disk__s" kindref="compound">virtual_disk_t</ref><sp/>*r5,<sp/><ref refid="structstripe__s" kindref="compound">stripe_t</ref><sp/>*tocompute,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>indice_parite){</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><ref refid="structblock__s" kindref="compound">block_t</ref><sp/>retour=tocompute-&gt;<ref refid="structstripe__s_1a16ff6d534dd4944c7fc544e4247e5ff1" kindref="member">stripe</ref>[(indice_parite+1)%(tocompute-&gt;<ref refid="structstripe__s_1a076c8e8b7f7acccc46cd356bd8776b26" kindref="member">nblocks</ref>)];</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;i&lt;tocompute-&gt;<ref refid="structstripe__s_1a076c8e8b7f7acccc46cd356bd8776b26" kindref="member">nblocks</ref>;i++){</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(i!=indice_parite<sp/>&amp;&amp;<sp/>i!=((indice_parite+1)%(tocompute-&gt;<ref refid="structstripe__s_1a076c8e8b7f7acccc46cd356bd8776b26" kindref="member">nblocks</ref>))){</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="couche1_8c_1a69d295ba0ccd1a14fbc7ef4dd2c3a5c9" kindref="member">xorbl</ref>(&amp;retour,&amp;(tocompute-&gt;<ref refid="structstripe__s_1a16ff6d534dd4944c7fc544e4247e5ff1" kindref="member">stripe</ref>[i]),&amp;retour);</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>retour;</highlight></codeline>
<codeline lineno="43"><highlight class="normal">}</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight></codeline>
<codeline lineno="50" refid="couche2_8h_1a70860f329dcd21100a6648089f864ed0" refkind="member"><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="couche2_8c_1a70860f329dcd21100a6648089f864ed0" kindref="member">compute_parity_index</ref>(<ref refid="structvirtual__disk__s" kindref="compound">virtual_disk_t</ref><sp/>*r5,</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>numbd){</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(numbd<sp/>%<sp/>r5-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref><sp/>==<sp/>0){</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>r5-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref>-1;</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((r5-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref>-1)-(numbd%r5-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref>));</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//return<sp/>abs(((r5-&gt;ndisk)-numbd-1)%(r5-&gt;ndisk));</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal">}</highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight></codeline>
<codeline lineno="63" refid="couche2_8h_1a5033c8eea4a4da6a76284e361f13240d" refkind="member"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="couche2_8c_1a5033c8eea4a4da6a76284e361f13240d" kindref="member">write_stripe</ref>(<ref refid="structvirtual__disk__s" kindref="compound">virtual_disk_t</ref><sp/>*r5,<sp/><ref refid="structstripe__s" kindref="compound">stripe_t</ref><sp/>*ecrire,<sp/><ref refid="raid__defines_8h_1a91ad9478d81a7aaf2593e8d9c3d06a14" kindref="member">uint</ref><sp/>pos){</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;i&lt;r5-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref>;i++){</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="couche1_8c_1adb4607cf11ffed5c89fc0f4682bf6079" kindref="member">write_block</ref>(r5,<sp/>&amp;(ecrire-&gt;<ref refid="structstripe__s_1a16ff6d534dd4944c7fc544e4247e5ff1" kindref="member">stripe</ref>[i]),<sp/>pos,<sp/>i);</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="67"><highlight class="normal">}</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight></codeline>
<codeline lineno="70" refid="couche2_8h_1ab6170c9cc6975d296a0bccfea207d415" refkind="member"><highlight class="normal"><ref refid="structstripe__s" kindref="compound">stripe_t</ref><sp/>*<ref refid="couche2_8c_1ab6170c9cc6975d296a0bccfea207d415" kindref="member">init_bande</ref>(<ref refid="structvirtual__disk__s" kindref="compound">virtual_disk_t</ref><sp/>*r5){</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><ref refid="structstripe__s" kindref="compound">stripe_t</ref><sp/>*bande<sp/>=<sp/>malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structstripe__s" kindref="compound">stripe_t</ref>));</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/>bande-&gt;<ref refid="structstripe__s_1a076c8e8b7f7acccc46cd356bd8776b26" kindref="member">nblocks</ref><sp/>=<sp/>r5-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref>;</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/>bande-&gt;<ref refid="structstripe__s_1a16ff6d534dd4944c7fc544e4247e5ff1" kindref="member">stripe</ref><sp/>=<sp/>malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structblock__s" kindref="compound">block_t</ref>)*r5-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref>);</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bande;</highlight></codeline>
<codeline lineno="75"><highlight class="normal">}</highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="82" refid="couche2_8h_1adf66b9197c93775a6c1dba723ba92a07" refkind="member"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="couche2_8c_1adf66b9197c93775a6c1dba723ba92a07" kindref="member">delete_bande</ref>(<ref refid="structstripe__s" kindref="compound">stripe_t</ref><sp/>**bande){</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/>free((*bande)-&gt;stripe);</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/>free(*bande);</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/>*bande<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="86"><highlight class="normal">}</highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight></codeline>
<codeline lineno="93" refid="couche2_8h_1a2fa67e5d44f8746a06cc56ef2876c45e" refkind="member"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="couche2_8c_1a2fa67e5d44f8746a06cc56ef2876c45e" kindref="member">print_stripe</ref>(<ref refid="structvirtual__disk__s" kindref="compound">virtual_disk_t</ref><sp/>*r5,<ref refid="structstripe__s" kindref="compound">stripe_t</ref><sp/>*stripe){</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><ref refid="structblock__s" kindref="compound">block_t</ref><sp/>current;</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>nbHexa[<ref refid="raid__defines_8h_1ad51ded0bbd705f02f73fc60c0b721ced" kindref="member">BLOCK_SIZE</ref>*2];</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;i&lt;r5-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref>;i++){</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/>current=stripe-&gt;<ref refid="structstripe__s_1a16ff6d534dd4944c7fc544e4247e5ff1" kindref="member">stripe</ref>[i];</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="couche1_8c_1a1fc20a5afdea4eec626e52a499ff46cd" kindref="member">octetsToHexa</ref>(current,<sp/>nbHexa);</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;<sp/>i&lt;<ref refid="raid__defines_8h_1ad51ded0bbd705f02f73fc60c0b721ced" kindref="member">BLOCK_SIZE</ref>*2;<sp/>i++){</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(stdout,<sp/></highlight><highlight class="stringliteral">&quot;[%c]&quot;</highlight><highlight class="normal">,<sp/>nbHexa[i]);</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="105"><highlight class="normal">}</highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="112" refid="couche2_8h_1a7ba1127dd9f6b03cbef1c8974790d3c6" refkind="member"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="couche2_8c_1a7ba1127dd9f6b03cbef1c8974790d3c6" kindref="member">write_chunk</ref>(<ref refid="structvirtual__disk__s" kindref="compound">virtual_disk_t</ref><sp/>*r5,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*buffer,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n,<sp/><ref refid="raid__defines_8h_1a91ad9478d81a7aaf2593e8d9c3d06a14" kindref="member">uint</ref><sp/>startBlock){</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nbBlocks<sp/>=<sp/><ref refid="couche1_8c_1a9cd7d6dccecc07ca1b67fd05c7928ee3" kindref="member">compute_nblock</ref>(n);</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nbBandes<sp/>=<sp/><ref refid="couche2_8c_1a3e5eab04f9ea03705105756c7b8c0782" kindref="member">compute_nstripe</ref>(r5,nbBlocks);</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pos<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><ref refid="structblock__s" kindref="compound">block_t</ref><sp/>bloc[nbBlocks];</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i&lt;nbBlocks;<sp/>i++){</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j&lt;<ref refid="raid__defines_8h_1ad51ded0bbd705f02f73fc60c0b721ced" kindref="member">BLOCK_SIZE</ref>;<sp/>j++){</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pos&lt;n){</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bloc[i].<ref refid="structblock__s_1aeb657a9749b851021c3ef39acaf7b252" kindref="member">data</ref>[j]<sp/>=<sp/>buffer[pos];</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos++;</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bloc[i].<ref refid="structblock__s_1aeb657a9749b851021c3ef39acaf7b252" kindref="member">data</ref>[j]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//Pos<sp/>sert<sp/>maintenant<sp/>de<sp/>numdeParité<sp/>pour<sp/>les<sp/>bandes.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/>pos<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><ref refid="structstripe__s" kindref="compound">stripe_t</ref><sp/>*bande=<ref refid="couche2_8c_1ab6170c9cc6975d296a0bccfea207d415" kindref="member">init_bande</ref>(r5);</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;=<sp/>nbBandes;<sp/>i++){<sp/><sp/><sp/></highlight><highlight class="comment">//On<sp/>parcourt<sp/>le<sp/>nbBandes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/>pos<sp/>=<sp/><ref refid="couche2_8c_1a70860f329dcd21100a6648089f864ed0" kindref="member">compute_parity_index</ref>(r5,<sp/>i);<sp/></highlight><highlight class="comment">//On<sp/>recupere<sp/>l&apos;indice<sp/>de<sp/>parite</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x=0;</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;=<sp/>r5-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref><sp/>-<sp/>1<sp/>;<sp/>j++){<sp/></highlight><highlight class="comment">//On<sp/>ajoute<sp/>à<sp/>la<sp/>bande<sp/>les<sp/>blocs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(j<sp/>!=<sp/>pos){</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bande-&gt;<ref refid="structstripe__s_1a16ff6d534dd4944c7fc544e4247e5ff1" kindref="member">stripe</ref>[j]=bloc[(i*(r5-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref><sp/>-<sp/>1))+j-x];<sp/></highlight><highlight class="comment">//<sp/>ajout<sp/>de<sp/>bloc<sp/>de<sp/>donnees</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="comment">//<sp/>Fin<sp/>IF</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x=1;</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="comment">//<sp/>Fin<sp/>FOR<sp/>j</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/>bande-&gt;<ref refid="structstripe__s_1a16ff6d534dd4944c7fc544e4247e5ff1" kindref="member">stripe</ref>[pos]<sp/>=<sp/><ref refid="couche2_8c_1a9e6de3169d502aae6d8117e1e6ab03a0" kindref="member">compute_parity</ref>(r5,<sp/>bande,<sp/>pos);</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="couche2_8c_1a5033c8eea4a4da6a76284e361f13240d" kindref="member">write_stripe</ref>(r5,<sp/>bande,<sp/>startBlock*4);<sp/></highlight><highlight class="comment">//<sp/>ecriture<sp/>de<sp/>la<sp/>bande<sp/>sur<sp/>disque</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/>startBlock+=1;<sp/><sp/></highlight><highlight class="comment">//<sp/>Decalage<sp/>du<sp/>block<sp/>de<sp/>depart<sp/>de<sp/>un<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="comment">//<sp/>Fin<sp/>FOR<sp/>i</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><ref refid="couche2_8c_1adf66b9197c93775a6c1dba723ba92a07" kindref="member">delete_bande</ref>(&amp;bande);</highlight></codeline>
<codeline lineno="147"><highlight class="normal">}</highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight><highlight class="comment">/*pas<sp/>pris<sp/>en<sp/>compte<sp/>l&apos;eventualité<sp/>de<sp/>commencer<sp/>au<sp/>milieu<sp/>d&apos;une<sp/>bande*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight></codeline>
<codeline lineno="150" refid="couche2_8c_1a37df3c8400bc0d4673471a52757d023a" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="couche2_8c_1a37df3c8400bc0d4673471a52757d023a" kindref="member">afficher_raid_hexa</ref>(<ref refid="structvirtual__disk__s" kindref="compound">virtual_disk_t</ref><sp/>*r5){</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>retour=0;</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>z=0;</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(retour!=1){</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;i&lt;r5-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref>;i++){</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>retour=<ref refid="couche1_8c_1ae6cedff3423d9b8afe126d3f298576ee" kindref="member">affichageBlockHexa</ref>(r5,i,z,stdout);</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(retour){</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">(retour);</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/>z=z+4;</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="165"><highlight class="normal">}</highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight></codeline>
<codeline lineno="172" refid="couche2_8c_1a5e216cfa058baf4a67b6fc96773fe095" refkind="member"><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="couche2_8c_1a5e216cfa058baf4a67b6fc96773fe095" kindref="member">afficher_raid_decimal</ref>(<ref refid="structvirtual__disk__s" kindref="compound">virtual_disk_t</ref><sp/>*r5){</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>retour=0;</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>z=0;</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(retour!=1){</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;i&lt;r5-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref>;i++){</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>retour=<ref refid="couche1_8c_1a1a6021fbd31ca2b308d61050416ab520" kindref="member">affichageBlockDecimal</ref>(r5,i,z,stdout);</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(retour){</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">(retour);</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/>z=z+4;</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="187"><highlight class="normal">}</highlight></codeline>
<codeline lineno="188"><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal"></highlight></codeline>
<codeline lineno="194" refid="couche2_8h_1abc2b7fd9807ede9a34e0d2bea6e9521c" refkind="member"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="couche2_8c_1abc2b7fd9807ede9a34e0d2bea6e9521c" kindref="member">cmd_test1</ref>(<ref refid="structvirtual__disk__s" kindref="compound">virtual_disk_t</ref><sp/>*r5){</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>buffer[256];</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><ref refid="couche2_8c_1a5e216cfa058baf4a67b6fc96773fe095" kindref="member">afficher_raid_decimal</ref>(r5);</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;i&lt;256;i++){</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/>buffer[i]=i;</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><ref refid="couche2_8c_1a7ba1127dd9f6b03cbef1c8974790d3c6" kindref="member">write_chunk</ref>(r5,buffer,256,0);</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;\n\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><ref refid="couche2_8c_1a37df3c8400bc0d4673471a52757d023a" kindref="member">afficher_raid_hexa</ref>(r5);</highlight></codeline>
<codeline lineno="203"><highlight class="normal">}</highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"></highlight></codeline>
<codeline lineno="211" refid="couche2_8h_1aea9498cb46077bb21181922c96e8329f" refkind="member"><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="couche2_8c_1aea9498cb46077bb21181922c96e8329f" kindref="member">read_stripe</ref>(<ref refid="structvirtual__disk__s" kindref="compound">virtual_disk_t</ref><sp/>*r5,<sp/><ref refid="structstripe__s" kindref="compound">stripe_t</ref><sp/>*lire,<sp/><ref refid="raid__defines_8h_1a91ad9478d81a7aaf2593e8d9c3d06a14" kindref="member">uint</ref><sp/>pos){</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>retour=0;</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;i&lt;r5-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref>;i++){</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/>retour=<ref refid="couche1_8c_1a4ba30a1143e543d465725eb0f151c6a2" kindref="member">read_block</ref>(r5,<sp/>&amp;(lire-&gt;<ref refid="structstripe__s_1a16ff6d534dd4944c7fc544e4247e5ff1" kindref="member">stripe</ref>[i]),<sp/>pos,<sp/>i);</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(retour){</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Erreur<sp/>lecture<sp/>,<sp/>arrêt\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="221"><highlight class="normal">}</highlight></codeline>
<codeline lineno="222"><highlight class="normal"></highlight></codeline>
<codeline lineno="228" refid="couche2_8c_1a2c76b4c3607585f36f7e7653fb96d633" refkind="member"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="couche2_8c_1a2c76b4c3607585f36f7e7653fb96d633" kindref="member">cmd_test2</ref>(<ref refid="structvirtual__disk__s" kindref="compound">virtual_disk_t</ref><sp/>*r5){</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>buffer[256];</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><ref refid="couche2_8c_1a37df3c8400bc0d4673471a52757d023a" kindref="member">afficher_raid_hexa</ref>(r5);</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><ref refid="couche2_8c_1a1868b67f893921ee137623a23e4b6dd8" kindref="member">read_chunk</ref>(r5,0,48);</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;\n\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><ref refid="couche1_8c_1a0f31c284e3b9461448ae2c5393a4c53f" kindref="member">turn_off_disk_raid5</ref>(r5);</highlight></codeline>
<codeline lineno="234"><highlight class="normal">}</highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight></codeline>
<codeline lineno="242" refid="couche2_8c_1a1365b1597af91528776b50b5bc418a08" refkind="member"><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="couche2_8c_1a1365b1597af91528776b50b5bc418a08" kindref="member">compute_num_bande</ref>(<ref refid="structvirtual__disk__s" kindref="compound">virtual_disk_t</ref><sp/>*r5,</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nbloc){</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nbloc/r5-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref>;</highlight></codeline>
<codeline lineno="244"><highlight class="normal">}</highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight></codeline>
<codeline lineno="251" refid="couche2_8h_1a1868b67f893921ee137623a23e4b6dd8" refkind="member"><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="couche2_8c_1a1868b67f893921ee137623a23e4b6dd8" kindref="member">read_chunk</ref>(<ref refid="structvirtual__disk__s" kindref="compound">virtual_disk_t</ref><sp/>*r5,<sp/><ref refid="raid__defines_8h_1a91ad9478d81a7aaf2593e8d9c3d06a14" kindref="member">uint</ref><sp/>start_block,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n){</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><ref refid="raid__defines_8h_1a91ad9478d81a7aaf2593e8d9c3d06a14" kindref="member">uint</ref><sp/>nbBlocks<sp/>=<sp/><ref refid="couche1_8c_1a9cd7d6dccecc07ca1b67fd05c7928ee3" kindref="member">compute_nblock</ref>(n);</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*buffer=malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">)*n);</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>indice_buffer=0;</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>current=start_block;</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nbBlocksLus<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*Nombre<sp/>de<sp/>Blocks<sp/>effectivement<sp/>lus<sp/>(sans<sp/>lire<sp/>les<sp/>blocs<sp/>de<sp/>parité)*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><ref refid="structblock__s" kindref="compound">block_t</ref><sp/>*blc=malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structblock__s" kindref="compound">block_s</ref>));</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Lecture<sp/>de<sp/>chunk<sp/>:<sp/>[start]:%d<sp/>,[end]:%d<sp/>,[size]:%d\n&quot;</highlight><highlight class="normal">,start_block,start_block+n,<ref refid="couche1_8c_1a9cd7d6dccecc07ca1b67fd05c7928ee3" kindref="member">compute_nblock</ref>(n));</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">((<ref refid="raid__defines_8h_1a91ad9478d81a7aaf2593e8d9c3d06a14" kindref="member">uint</ref>)<sp/>nbBlocksLus&lt;nbBlocks){</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;\nCurrent<sp/>block<sp/>:%d\n&quot;</highlight><highlight class="normal">,current);</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(current%(r5-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref>)!=<ref refid="couche2_8c_1a70860f329dcd21100a6648089f864ed0" kindref="member">compute_parity_index</ref>(r5,<sp/><ref refid="couche2_8c_1a1365b1597af91528776b50b5bc418a08" kindref="member">compute_num_bande</ref>(r5,current))){</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Reading<sp/>position<sp/>%d<sp/>at<sp/>disk<sp/>%d\n&quot;</highlight><highlight class="normal">,(current/4)*4,current%r5-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref>);</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="couche1_8c_1a4ba30a1143e543d465725eb0f151c6a2" kindref="member">read_block</ref>(r5,blc,(current/4)*4,current%r5-&gt;<ref refid="structvirtual__disk__s_1a879b20de8088f4342835d5fb3feb1141" kindref="member">ndisk</ref>);</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;<sp/>i&lt;<ref refid="raid__defines_8h_1ad51ded0bbd705f02f73fc60c0b721ced" kindref="member">BLOCK_SIZE</ref>;<sp/>i++){</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buffer[indice_buffer]=blc-&gt;<ref refid="structblock__s_1aeb657a9749b851021c3ef39acaf7b252" kindref="member">data</ref>[i];</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;%d<sp/>&quot;</highlight><highlight class="normal">,blc-&gt;<ref refid="structblock__s_1aeb657a9749b851021c3ef39acaf7b252" kindref="member">data</ref>[i]);</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>indice_buffer=indice_buffer+1;</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nbBlocksLus++;</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/>current++;</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/>free(blc);</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>buffer;</highlight></codeline>
<codeline lineno="275"><highlight class="normal">}</highlight></codeline>
<codeline lineno="276"><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"></highlight></codeline>
<codeline lineno="278" refid="couche2_8h_1a38818187df03f330b062dcc1b3cf78df" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="couche2_8c_1a38818187df03f330b062dcc1b3cf78df" kindref="member">couche2</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">){</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//couche1();</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><ref refid="structvirtual__disk__s" kindref="compound">virtual_disk_t</ref><sp/>*r5d=malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structvirtual__disk__s" kindref="compound">virtual_disk_t</ref>));</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><ref refid="couche1_8c_1a745e214ead4cfa64503c1be97c30d25a" kindref="member">init_disk_raid5</ref>(</highlight><highlight class="stringliteral">&quot;./RAIDFILES&quot;</highlight><highlight class="normal">,r5d);</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><ref refid="couche2_8c_1abc2b7fd9807ede9a34e0d2bea6e9521c" kindref="member">cmd_test1</ref>(r5d);</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;\nCMD_TEST2\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><ref refid="couche2_8c_1a2c76b4c3607585f36f7e7653fb96d633" kindref="member">cmd_test2</ref>(r5d);</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="286"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="couche2.c"/>
  </compounddef>
</doxygen>
